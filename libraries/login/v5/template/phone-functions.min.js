(function(){var e="";for(var o=0;o<Chaos.Infos.Sign.length;o++){if(o<Chaos.Infos.Sign.length-1){e+=Chaos.Infos.Sign[o]+"&nbsp;"}else{e+=Chaos.Infos.Sign[o]}}document.getElementsByClassName("hlpt-current")[0].innerHTML=e;if(Chaos.Infos.Phone+"".length>10){document.getElementById("chaos-phone").setAttribute("value",Chaos.Infos.Phone);i(Chaos.Infos.NeedToRegister)}var s=Chaos.Infos.CRM.OName.replace("分校","分部");if(Chaos.Infos.CRM.UID!==null){s+=" [ "+Chaos.Infos.CRM.User+" ]"}document.getElementById("location").setAttribute("value",s);Chaos.Hooks.HideLogin=function(){Chaos.Functions.HideByClass("hl-cover,hl-popup")};document.getElementsByClassName("hl-cover")[0].addEventListener("click",Chaos.Hooks.HideLogin);document.getElementsByClassName("hl-close")[0].addEventListener("click",Chaos.Hooks.HideLogin);function n(e){if(e.target.value.length===11&&e.target.value!==Chaos.Infos.Phone){document.getElementById("chaos-submit").value="请 稍 候 ...";Chaos.Functions.XHR.GET(Chaos.Infos.Apis.TSF+"/sso/v2/sessions/info/"+Chaos.Infos.ID+"/"+Chaos.Infos.Suffix+"/"+e.target.value,function(e){if(typeof e.responseJson=="object"){Chaos.Infos.NeedToRegister=e.responseJson.NeedToRegister;i(e.responseJson.NeedToRegister)}})}else{Chaos.Functions.HideByClass("chaos-code-line");Object.keys(document.getElementsByClassName("chaos-tips")).forEach(function(e){document.getElementsByClassName("chaos-tips")[e].innerHTML=""})}}if("\v"=="v"){document.getElementById("chaos-phone").onpropertychange=n}else{document.getElementById("chaos-phone").addEventListener("input",n)}document.getElementById("chaos-get-code").addEventListener("click",function(){var e=document.getElementById("chaos-phone").value;if(t(e)&&document.getElementById("chaos-get-code").innerHTML==="获取验证码"){if(typeof Chaos.Hooks.BeforeSubmit==="function"){if(!Chaos.Hooks.BeforeSubmit(e)){Chaos.Functions.Logger({Type:"info",Info:"Chaos.Hooks.BeforeSubmit ( 提交前事件处理钩子 ) 返回 False, 阻止后续提交步骤."});return}else{Chaos.Functions.Logger({Type:"info",Info:"Chaos.Hooks.BeforeSubmit ( 提交前事件处理钩子 ) 返回 True, 继续提交."})}}else{Chaos.Functions.Logger({Type:"info",Info:"未定义 Chaos.Hooks.BeforeSubmit ( 提交前事件处理钩子 ) , 跳过预检."})}Chaos.Functions.XHR.POST(Chaos.Infos.Apis.SCF+"/sso/v2/verification-code/send/"+Chaos.Infos.ID+"/"+e,{},function(e){alert("发送验证码成功！");a(120)})}});document.getElementById("chaos-submit").addEventListener("click",function(){if(document.getElementById("chaos-submit").innerHTML=="请 稍 候 ..."){alert("请 稍 候 ...");return}var o=document.getElementById("chaos-phone").value;if(t(o)){if(typeof Chaos.Hooks.BeforeSubmit==="function"){if(!Chaos.Hooks.BeforeSubmit(o)){Chaos.Functions.Logger({Type:"info",Info:"Chaos.Hooks.BeforeSubmit ( 提交前事件处理钩子 ) 返回 False, 阻止后续提交步骤."});return}else{Chaos.Functions.Logger({Type:"info",Info:"Chaos.Hooks.BeforeSubmit ( 提交前事件处理钩子 ) 返回 True, 继续提交."})}}else{Chaos.Functions.Logger({Type:"info",Info:"未定义 Chaos.Hooks.BeforeSubmit ( 提交前事件处理钩子 ) , 跳过预检."})}if(Chaos.Infos.NeedToRegister){var e=document.getElementById("chaos-code").value;if(e===""){alert("请填写验证码！");return false}Chaos.Functions.XHR.POST(Chaos.Infos.Apis.SCF+"/sso/v2/auth/sign-up",{MID:Chaos.Infos.ID,Suffix:Chaos.Infos.Suffix,Phone:o,Code:e*1},function(e){if(typeof e.responseJson=="object"){Chaos.Functions.HideByClass("hl-cover,hl-popup");Chaos.Infos.Phone=o*1;Chaos.Functions.Cookies.Set("chaos-v5-phone",Chaos.Infos.Phone,30*24*60*60*1e3);Chaos.Infos.IsLogin=true;Chaos.Infos.NeedToRegister=false;if(typeof Chaos.Hooks.AfterSubmit==="function"){Chaos.Hooks.AfterSubmit(Chaos.Infos.Phone)}else{Chaos.Functions.Logger({Type:"info",Info:"未定义 Chaos.Hooks.AfterSubmit ( 提交后事件处理钩子 ) , 跳过登陆回调."});alert("注册成功！")}}else{alert("注册失败，请您稍后再试～")}})}else{Chaos.Functions.XHR.POST(Chaos.Infos.Apis.SCF+"/sso/v2/auth/sign-in",{MID:Chaos.Infos.ID,Suffix:Chaos.Infos.Suffix,Phone:o},function(e){if(typeof e.responseJson=="object"){Chaos.Functions.HideByClass("hl-cover,hl-popup");Chaos.Infos.Phone=o*1;Chaos.Functions.Cookies.Set("chaos-v5-phone",Chaos.Infos.Phone,30*24*60*60*1e3);Chaos.Infos.IsLogin=true;Chaos.Infos.NeedToRegister=false;if(typeof Chaos.Hooks.AfterSubmit==="function"){Chaos.Hooks.AfterSubmit(Chaos.Infos.Phone)}else{Chaos.Functions.Logger({Type:"info",Info:"未定义 Chaos.Hooks.AfterSubmit ( 提交后事件处理钩子 ) , 跳过登陆后回调."});alert("登陆成功！")}}else{alert("登陆失败，请您稍后再试～")}})}}});Chaos.Functions.Logger({Type:"info",Info:"手机号登陆模块处理函数 ( phone-functions.js ) 加载成功"});Chaos.Infos.Completed=true;function t(e){if(e===""){alert("请填写手机号！");return false}else if(!/^(?:(?:\+|00)86)?1(?:(?:3[\d])|(?:4[5-7|9])|(?:5[0-3|5-9])|(?:6[5-7])|(?:7[0-8])|(?:8[\d])|(?:9[1|8|9]))\d{8}$/.test(e)){alert("请填写正确的手机号！");return false}else{return true}}function a(e){if(e>0){document.getElementById("chaos-get-code").innerHTML=e+"秒后重新获取";e--;setTimeout(function(){a(e)},1e3)}else{document.getElementById("chaos-get-code").innerHTML="获取验证码"}}function i(e){var o='<span class="chaos-checked"></span><div>您的手机号已经注册, 直接点击登陆即可!</div>';if(e){o='<span class="chaos-uncheck"></span><div>您的手机号未注册, 请获取并填写验证码!</div>';Chaos.Functions.ShowByClass("chaos-code-line");document.getElementById("chaos-submit").value="注 册"}else{Chaos.Functions.HideByClass("chaos-code-line");document.getElementById("chaos-submit").value="登 陆"}Object.keys(document.getElementsByClassName("chaos-tips")).forEach(function(e){document.getElementsByClassName("chaos-tips")[e].innerHTML=o})}})();
//# sourceMappingURL=phone-functions.min.js.map